<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PanaderÃ­a Dulce Herencia</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
</head>
<body>
    <div class="app-container">
        <!-- Encabezado -->
        <header class="header">
            <div class="logo">
                <img src="assets/logo.png" alt="Dulce Herencia" class="logo-img" onerror="this.style.display='none'">
                <h1>ğŸ§ PanaderÃ­a Dulce Herencia ğŸ¥–</h1>
            </div>
            <div class="user-info">
                <span>Bienvenido, Admin</span>
            </div>
        </header>

        <!-- MenÃº principal -->
        <nav class="main-menu">
            <button class="menu-btn active" data-module="inicio">
                <span class="icon">ğŸ </span>
                <span>Inicio</span>
            </button>
            <button class="menu-btn" data-module="punto-venta">
                <span class="icon">ğŸ›’</span>
                <span>Punto de Venta</span>
            </button>
            <button class="menu-btn" data-module="historial-ventas">
                <span class="icon">ğŸ“‹</span>
                <span>Historial Ventas</span>
            </button>
            <button class="menu-btn" data-module="instrumentos">
                <span class="icon">ğŸ› ï¸</span>
                <span>Instrumentos</span>
            </button>
            <button class="menu-btn" data-module="empleados">
                <span class="icon">ğŸ‘¥</span>
                <span>Empleados</span>
            </button>
            <button class="menu-btn" data-module="productos">
                <span class="icon">ğŸ¥</span>
                <span>Productos</span>
            </button>
            <button class="menu-btn" data-module="ganancias">
                <span class="icon">ğŸ“Š</span>
                <span>Ganancias</span>
            </button>
            <button class="menu-btn" data-module="materia-prima">
                <span class="icon">ğŸ“¦</span>
                <span>Materia Prima</span>
            </button>
            <button class="menu-btn" data-module="graficas">
                <span class="icon">ğŸ“ˆ</span>
                <span>GrÃ¡ficas</span>
            </button>
            <button class="menu-btn" data-module="salir" id="btn-salir">
                <span class="icon">ğŸšª</span>
                <span>Salir</span>
            </button>
        </nav>

        <!-- Contenido principal (cambiarÃ¡ segÃºn el mÃ³dulo) -->
        <main id="contenido-principal" class="content">
            <!-- MÃ³dulo Inicio -->
            <div id="inicio" class="module active">
                <h2>Panel de Control</h2>
                <p>Bienvenido al sistema de gestiÃ³n de tu panaderÃ­a. Selecciona un mÃ³dulo del menÃº para comenzar.</p>
                <div class="cards-container" id="inicio-resumen">
                    <!-- Se llenarÃ¡ con JavaScript -->
                </div>
            </div>
        </main>

        <!-- Pie de pÃ¡gina -->
        <footer class="footer">
            <p>&copy; 2026 PanaderÃ­a Dulce Herencia - Sistema de GestiÃ³n</p>
        </footer>
    </div>

    <!-- PRIMERO: Script principal (funciones globales) -->
    <script src="script.js"></script>

    <!-- SEGUNDO: MÃ³dulos de sistema (base de datos y exportaciÃ³n) -->
    <script src="modules/database.js"></script>
    <script src="modules/exportador.js"></script>

    <!-- TERCERO: MÃ³dulos de negocio (ordenados por dependencia) -->
    <script src="modules/productos.js"></script>      <!-- Base para ventas -->
    <script src="modules/instrumentos.js"></script>
    <script src="modules/empleados.js"></script>
    <script src="modules/materia_prima.js"></script>
    <script src="modules/punto_venta.js"></script>    <!-- Depende de productos -->
    <script src="modules/ventas.js"></script>         <!-- Historial -->
    <script src="modules/ganancias.js"></script>      <!-- Depende de ventas -->
    <script src="modules/graficas.js"></script>       <!-- Depende de ventas -->

    <!-- BotÃ³n de reseteo seguro (al final para asegurar que el DOM cargÃ³) -->
    <div style="position: fixed; bottom: 10px; right: 10px; opacity: 0.2; z-index: 9999;">
        <button id="resetSecreto" style="padding: 5px 10px; background: #333; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 12px;" title="MantÃ©n Ctrl+Shift y haz clic para resetear">
            ğŸ”„ RESET (Seguro)
        </button>
    </div>

    <script>
        // BotÃ³n de reseteo seguro (requiere Ctrl+Shift+Click)
        document.addEventListener('DOMContentLoaded', function() {
            const resetBtn = document.getElementById('resetSecreto');
            if (resetBtn) {
                resetBtn.addEventListener('click', function(e) {
                    if (e.ctrlKey && e.shiftKey) {
                        if (confirm('ğŸ”¥ Â¿RESETEAR COMPLETAMENTE TODOS LOS DATOS?\n\nSe borrarÃ¡n ventas, productos, empleados, inversiones...')) {
                            if (confirm('âš ï¸ ÃšLTIMA OPORTUNIDAD: Â¿EstÃ¡s ABSOLUTAMENTE seguro?')) {
                                console.log('ğŸ”¥ INICIANDO RESETEO TOTAL...');
                                
                                // Lista de todas las claves de localStorage
                                const claves = [
                                    'ventas', 'productos', 'instrumentos', 'empleados', 
                                    'materiaPrima', 'metas', 'inversiones', 'carrito'
                                ];
                                
                                // Borrar localStorage especÃ­fico
                                claves.forEach(key => {
                                    localStorage.removeItem(key);
                                    console.log(`âœ… Eliminado: ${key}`);
                                });
                                
                                // Borrar todo el localStorage por si acaso
                                localStorage.clear();
                                
                                // Eliminar IndexedDB
                                if (window.indexedDB) {
                                    const request = indexedDB.deleteDatabase('DulceHerenciaDB');
                                    request.onsuccess = () => {
                                        alert('âœ… TODOS LOS DATOS HAN SIDO ELIMINADOS\n\nLa pÃ¡gina se recargarÃ¡.');
                                        location.reload();
                                    };
                                    request.onerror = () => {
                                        alert('âš ï¸ Datos de localStorage borrados. Recargando...');
                                        location.reload();
                                    };
                                } else {
                                    alert('âœ… Datos borrados. Recargando...');
                                    location.reload();
                                }
                            }
                        }
                    } else {
                        alert('ğŸ”’ BotÃ³n de seguridad: MantÃ©n presionada la tecla Ctrl y Shift mientras haces clic');
                    }
                });
            }
        });
    </script>
</body>
</html>